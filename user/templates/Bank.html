<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
  <!-- Required meta tags -->
    <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Colombus Capital</title>

    <link href="{{ url_for('user_bp.static', filename='img/white.png')}}" rel="icon">
  <link href="{{ url_for('user_bp.static', filename='img/apple-touch-icon.png')}}" rel="apple-touch-icon">
  <!-- plugins:css -->
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="{{ url_for('user_bp.static', filename='vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('user_bp.static', filename='vendor/bootstrap-icons/bootstrap-icons.css') }}" rel="stylesheet">
  <link href="{{ url_for('user_bp.static', filename='vendor/boxicons/css/boxicons.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('user_bp.static', filename='vendor/glightbox/css/glightbox.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('user_bp.static', filename='vendor/remixicon/remixicon.css') }}" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('user_bp.static', filename='css/bank.css') }}">
  <link rel="stylesheet" href="{{ url_for('user_bp.static', filename='css/dashboard.css') }}">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">




  <!-- endinject -->
  <link rel="shortcut icon" href="images/favicon.png" />
</head>
<body>
    <!-- Header Section -->
  <!-- Header Section -->
  <header id="header" class="fixed-top header-inner-pages">
    <div class="container d-flex align-items-center">
      <a href="{{ url_for('user_bp.home') }}" class="logo me-auto"><img src="{{ url_for('user_bp.static', filename='img/white.png')}}" class="img-fluid" alt="CC"></a>
      <nav id="navbar" class="navbar">
        <ul>
            <li><a class="nav-link scrollto active" href="{{ url_for('user_bp.main') }}">Main</a></li>
          <li><a class="nav-link scrollto active" href="{{ url_for('user_bp.dashboard') }}">Dashboard</a></li>
          <li><a class="nav-link scrollto" href="{{ url_for('user_bp.bank') }}">Bank Accounts</a></li>
          <li><a class="nav-link scrollto" href="{{ url_for('user_bp.order') }}">Order</a></li>
          <li><button type="button" class="getstarted scrollto" id="logoutButton" style="color: #071C42;background: #F3F5FA; font-family: 'Jost' font-weight: 800;">Logout</button></li>
        </ul>
      </nav><!-- .navbar -->
    </div>
  </header>
  <div class="container-scroller">
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-md-12 grid-margin">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h1></h1>
                </div>
                <div>
                    <button type="button" class="btn btn-primary btn-icon-text btn-rounded">
                      <i class="ti-clipboard btn-icon-prepend"></i>Report
                    </button>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title text-xl-left">Balance $</p>
                  <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                    <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">$ {{ total_euro_balance }}</h3>
                  </div>
                  <p class="mb-0 mt-2 text-danger">0.12% <span class="text-black ml-1"><small>(30 days)</small></span></p>
                </div>
              </div>
            </div>
            <div class="col-md-3 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title text-xl-left">Balance €</p>
                  <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                    <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">€ {{ total_dollar_balance }}</h3>
                  </div>
                  <p class="mb-0 mt-2 text-danger">0.47% <span class="text-black ml-1"><small>(30 days)</small></span></p>
                </div>
              </div>
            </div>
            <div class="col-md-3 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title text-xl-left">Balance TND</p>
                  <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                    <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">TND {{ total_tnd_balance }}</h3>
                  </div>
                  <p class="mb-0 mt-2 text-success">64.00%<span class="text-black ml-1"><small>(30 days)</small></span></p>
                </div>
              </div>
            </div>
            <div class="col-md-3 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title text-xl-left">Number of Accounts</p>
                  <div class="d-flex flex-wrap justify-content-between justify-content-md-center justify-content-xl-between align-items-center">
                    <h3 class="mb-0 mb-md-2 mb-xl-0 order-md-1 order-xl-0">{{ number_of_accounts }}</h3>
                  </div>
                  <p class="mb-0 mt-2 text-success">23.00%<span class="text-black ml-1"><small>(30 days)</small></span></p>
                </div>
              </div>
            </div>
          </div>
            <div class=" grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <div class="table-responsive">
                    <div class="filters">
                      <div class="filter-group">
                            <label for="filter-date" class="filter-label">Date</label>
                            <select id="filter-date" class="filter-select">
                                <option class="filter-select">All</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-currency" class="filter-label">Currency</label>
                            <select id="filter-currency" class="filter-select">
                                <option class="filter-select">All</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-bank"class="filter-label">Bank</label>
                            <select id="filter-bank" class="filter-select">
                                <option>All</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-balance"class="filter-label">Balance</label>
                            <input type="number" id="filter-balance" placeholder="Enter balance" class="filter-select">
                        </div>
                    </div>

                    </div>
                    <table class="table table-hover">
                      <thead>
                        <tr>
                          <th>Status</th>
                          <th>Account ID</th>
                          <th>Bank</th>
                          <th>Bank Branch</th>
                          <th>Account Number</th>
                          <th>Currency</th>
                          <th>Open Date</th>
                          <th>Category</th>
                          <th>Balance</th>
                        </tr>
                      </thead>
                      <tbody>
                      {% for row in data %}
                        <tr>
                                        <td>
                                            <div class="status-icon">
                                                {% if row['Status'] == 'Open' %}
                                                <i class="fas fa-circle text-success" style="padding-left:15px;"></i>
                                                {% elif row['Status'] == 'Suspended' %}
                                                <i class="fas fa-circle text-warning" style="padding-left:15px;"></i>
                                                {% elif row['Status'] == 'Close' %}
                                                <i class="fas fa-circle text-danger"style="padding-left:15px;"></i>
                                                {% endif %}
                                            </div>
                                        </td>
                                        <td>{{ row['Account ID'] }}</td>
                                        <td>{{ row['Bank'] }}</td>
                                        <td>{{ row['Branch'] }}</td>
                                        <td>{{ row['Account Number'] }}</td>
                                        <td>{{ row['Currency'] }}</td>
                                        <td>{{ row['Date'] }}</td>
                                        <td>{{ row['Category'] }}</td>
                                        <td>{{ row['Balance'] }}</td>
                                    </tr>
                                    {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

    <!-- Add new Bank Account -->
    <div class="share">
      <i class="fa fa-pen-fancy"></i>
    </div>
      <div class="two" data-toggle="modal" data-target="#newAccountModal">
        <i class="fa fa-plus"></i>
      </div>
    <!-- Trigger for Update Account Modal -->
    <div class="one" data-toggle="modal" data-target="#updateAccountModal">
        <i class="fa fa-edit"></i> <!-- Changed icon to edit -->
    </div>

    <!-- Trigger for Delete Account Modal -->
    <div class="three" data-toggle="modal" data-target="#deleteAccountModal">
        <i class="fa fa-minus"></i>
    </div>



<!-- New Account Modal -->
<div class="modal fade" id="newAccountModal" tabindex="-1" role="dialog" aria-labelledby="newAccountModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document" >
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="newAccountModalLabel">New Account Creation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
    <form action="/add_account" method="post">
        <div class="form-container">
         <div class="row">
                <!-- First Column -->
                <div class="col-md-6">
                <!-- Form fields for the first column -->
                    <div class="form-group">
                        <div>Bank</div>
                        <input type="text" value="" name="bank">
                    </div>
                    <div class="form-group">
                        <div>Currency</div>
                        <select name="currency">
                          <option>EUR</option>
                          <option>USD</option>
                          <option>TND</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <div>Owner</div>
                        <input type="text" value="" name="owner">
                    </div>

                    <div class="form-group">
                        <div>Balance</div>
                        <input type="number" value="0" name="balance">
                    </div>
                </div>
        <!-- Second Column -->
            <div class="col-md-6">
                <div class="form-group">
                        <div>Number Account</div>
                        <input type="text" name="nbrAcc">
                </div>
                <div class="form-group">
                    <div>Bank Branch</div>
                    <input type="text" name="branch">
                </div>
                <div class="form-group">
                    <div>Category</div>
                    <select name="category">
                      <option>Saving</option>
                        <option>Credit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">Date</label>
                    <input type="date" id="date" name="date" required class="form-control" />
                </div>
            </div>
         </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn login" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn login">Confirm</button>
        </div>
    </form>
      </div>
    </div>
  </div>
  </div>
</div>

<!-- Update Account Modal -->
<div class="modal fade" id="updateAccountModal" tabindex="-1" role="dialog" aria-labelledby="updateAccountModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="updateAccountModalLabel">Update Account</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="updateAccountForm">
          <!-- Include similar fields as in the creation form but with an additional select for choosing the account -->
          <div class="form-group">
            <label for="update-account-id">Account ID</label>
            <select id="update-account-id" name="account_id" class="form-control">
                {% for row in data %}
                <option value="{{ row['Account ID'] }}">{{ row['Account ID'] }}</option>
                {% endfor %}
            </select>
          </div>
          <div class="form-group">
                <label for="update-form-bank-name">Bank Name</label>
                <input type="text" class="form-control" id="update-form-bank-name" name="bank_name">
            </div>

            <div class="form-group">
                <label for="update-form-currency">Currency</label>
                <select class="form-control" id="update-form-currency" name="currency">
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                    <option value="TND">TND</option>
                </select>
            </div>

            <div class="form-group">
                <label for="update-form-balance">Balance</label>
                <input type="number" class="form-control" id="update-form-balance" name="balance" step="0.01">
            </div>

            <div class="form-group">
                <label for="update-form-category">Category</label>
                <select class="form-control" id="update-form-category" name="category">
                    <option value="Saving">Saving</option>
                    <option value="Checking">Checking</option>
                    <!-- Add other categories as needed -->
                </select>
            </div>

            <div class="form-group">
                <label for="update-form-category">Category</label>
                <select class="form-control" id="update-form-status" name="status">
                    <option value="Open">Open</option>
                    <option value="Suspended">Suspended</option>
                    <option value="Close">Close</option>
                    <!-- Add other categories as needed -->
                </select>
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="submit" form="updateAccountForm" class="btn btn-primary">Update Account</button>
      </div>
    </div>
  </div>
</div>

<!-- Delete Account Modal -->
<div class="modal fade" id="deleteAccountModal" tabindex="-1" role="dialog" aria-labelledby="deleteAccountModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteAccountModalLabel">Delete Account</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="deleteAccountForm">
          <div class="form-group">
            <label for="delete-account-id">Account ID</label>
            <select id="delete-account-id" name="account_id" class="form-control">
                {% for row in data %}
                <option value="{{ row['Account ID'] }}">{{ row['Account ID'] }}</option>
                {% endfor %}
            </select>
          </div>
          <p>Are you sure you want to delete this account?</p>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="submit" form="deleteAccountForm" class="btn btn-danger">Delete Account</button>
      </div>
    </div>
  </div>
</div>


         <!-- ======= Footer ======= -->
  <footer id="footer">

    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-3 col-md-6 footer-contact">
            <h3>Colombus Capital</h3>
            <p>
              Immeuble Tanit <br>
              Rue d’Erable<br>
              Lac II <br><br>
              <strong>Phone:</strong> +216 53 789 000<br>
              <strong>Email:</strong> contact@colombus-capital.com<br>
            </p>
          </div>

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="#">FX Regulation</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">FX Global Code</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Circular and Notes</a></li>
            </ul>
          </div>

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Our Services</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="https://www.bct.gov.tn/bct/siteprod/documents/Reg_des_Chges_ao13.pdf">FX Regulation</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="https://www.globalfxc.org/docs/fx_global.pdf">FX Global Code</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="https://www.cbf.org.tn/circulaires-et-notes-2/">Circular and Notes</a></li>
            </ul>
          </div>

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Our Social Networks</h4>
            <p>Keep connected on our social media</p>
            <div class="social-links mt-3">
              <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
              <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
              <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
              <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="container footer-bottom clearfix">
      <div class="copyright">
        &copy; Copyright <strong><span>Colombus Capital</span></strong>. All Rights Reserved
      </div>
    </div>
  </footer><!-- End Footer -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
  <!-- Custom JavaScript -->
  <script>
      // Wait for the document to be ready
      $(document).ready(function () {
          // Add an event listener to all status dropdowns
          $(".status-dropdown").change(function () {
              // Get the selected status
              let selectedStatus = $(this).val();

              // Find the corresponding status-icon div in the same row
              let statusIconDiv = $(this).closest("tr").find(".status-icon");

              // Remove any existing icons
              statusIconDiv.empty();

              // Add the circular icon based on the selected status
              if (selectedStatus === "Open") {
                  statusIconDiv.append('<div class="green-circular-icon"></div>');
              } else if (selectedStatus === "Suspended") {
                  statusIconDiv.append('<div class="yellow-circular-icon"></div>');
              } else if (selectedStatus === "Close") {
                  statusIconDiv.append('<div class="red-circular-icon"></div>');
              }
          });
      });
  </script>

    <script>
    // Your data containing all table rows
    var data = {{ data | tojson }};

    // Get reference to filter input fields and select dropdowns
    const filterDateInput = document.getElementById("filter-date");
    const filterCurrencySelect = document.getElementById("filter-currency");
    const filterBankSelect = document.getElementById("filter-bank");
    const filterBalanceInput = document.getElementById("filter-balance");

    // Get reference to table body
    const tableBody = document.querySelector("tbody");

    // Create sets to store unique values for each filter
    const uniqueDates = new Set();
    const uniqueCurrencies = new Set();
    const uniqueBanks = new Set();

    // Populate unique values from table data
    for (const row of data) {
        uniqueDates.add(row['Date']);
        uniqueCurrencies.add(row['Currency']);
        uniqueBanks.add(row['Bank']);
    }

    // Populate filter dropdowns with unique values
    uniqueDates.forEach(date => {
        const option = document.createElement("option");
        option.value = date;
        option.textContent = date;
        filterDateInput.appendChild(option);
    });

    uniqueCurrencies.forEach(currency => {
        const option = document.createElement("option");
        option.value = currency;
        option.textContent = currency;
        filterCurrencySelect.appendChild(option);
    });

    uniqueBanks.forEach(bank => {
        const option = document.createElement("option");
        option.value = bank;
        option.textContent = bank;
        filterBankSelect.appendChild(option);
    });
</script>
    <script>
    // Get reference to filter input fields and select dropdowns
    const filterDateInput = document.getElementById("filter-date");
    const filterCurrencySelect = document.getElementById("filter-currency");
    const filterBankSelect = document.getElementById("filter-bank");
    const filterBalanceInput = document.getElementById("filter-balance");

    // Get reference to table body
    const tableBody = document.querySelector("tbody");

    // Create sets to store unique values for each filter
    const uniqueDates = new Set();
    const uniqueCurrencies = new Set();
    const uniqueBanks = new Set();

    // Populate unique values from table data
    for (const row of tableBody.querySelectorAll("tr")) {
        uniqueDates.add(row.cells[4].textContent.toLowerCase());
        uniqueCurrencies.add(row.cells[3].textContent.toLowerCase());
        uniqueBanks.add(row.cells[1].textContent.toLowerCase());
    }

    // Populate filter dropdowns with unique values
    uniqueDates.forEach(date => {
        const option = document.createElement("option");
        option.value = date;
        option.textContent = date;
        filterDateInput.appendChild(option);
    });

    uniqueCurrencies.forEach(currency => {
        const option = document.createElement("option");
        option.value = currency;
        option.textContent = currency;
        filterCurrencySelect.appendChild(option);
    });

    uniqueBanks.forEach(bank => {
        const option = document.createElement("option");
        option.value = bank;
        option.textContent = bank;
        filterBankSelect.appendChild(option);
    });

    // Event listeners for filter inputs
    filterDateInput.addEventListener("input", filterTable);
    filterCurrencySelect.addEventListener("change", filterTable);
    filterBankSelect.addEventListener("change", filterTable);
    filterBalanceInput.addEventListener("input", filterTable);

    // Function to filter the table based on user input
    function filterTable() {
        const dateFilter = filterDateInput.value.toLowerCase();
        const currencyFilter = filterCurrencySelect.value.toLowerCase();
        const bankFilter = filterBankSelect.value.toLowerCase();
        const balanceFilter = parseFloat(filterBalanceInput.value);

        for (const row of tableBody.querySelectorAll("tr")) {
            const date = row.cells[4].textContent.toLowerCase();
            const currency = row.cells[3].textContent.toLowerCase();
            const bank = row.cells[1].textContent.toLowerCase();
            const balance = parseFloat(row.cells[7].textContent);

            const dateMatch = date.includes(dateFilter);
            const currencyMatch = currency.includes(currencyFilter) || currencyFilter === "all";
            const bankMatch = bank.includes(bankFilter) || bankFilter === "all";
            const balanceMatch = isNaN(balanceFilter) || balance === balanceFilter;

            if (dateMatch && currencyMatch && bankMatch && balanceMatch) {
                row.style.display = "";
            } else {
                row.style.display = "none";
            }
        }
    }

    // Initial table filtering
    filterTable();
</script>

    <!-- Include the jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        $(function() {
  var flag = 0;

  $('.share').on('click', function() {
    if(flag == 0) {
      // Animate buttons to their new positions
      $(this).siblings('.one').animate({
        bottom: '270px',
        right: '15px'
      }, 200);

      $(this).siblings('.two').delay(200).animate({
        bottom: '200px',
        right: '15px'
      }, 50);

      $(this).siblings('.three').delay(300).animate({
        bottom: '130px',
        right: '15px'
      }, 50);

      $('.one i, .two i, .three i').delay(500).fadeIn(50);
      flag = 1;
    } else {
      // Animate buttons back to their initial position
      $('.one, .two, .three').animate({
        bottom: '50px', // Initial position
        right: '15px' // Initial position
      }, 200);

      $('.one i, .two i, .three i').fadeOut(50);
      flag = 0;
    }
  });
});

  </script>

<script>
$(document).ready(function() {
    // Display success message after page reload, if it exists
    var updateSuccess = localStorage.getItem('updateSuccess');
    if (updateSuccess) {
        alert(updateSuccess); // Show success message
        localStorage.removeItem('updateSuccess'); // Ensure the message is only shown once
    }

    $('#updateAccountForm').on('submit', function(e) {
        e.preventDefault(); // Prevent default form submission

        var formData = Object.fromEntries(new FormData(this).entries());
        var accountId = $('#update-account-id').val();

        $.ajax({
            type: 'PUT',
            url: '/bank-accounts/' + accountId,
            contentType: 'application/json',
            data: JSON.stringify(formData),
            success: function(response) {
                // Store success message and reload
                localStorage.setItem('updateSuccess', response.message);
                window.location.reload();
            },
            error: function(response) {
                alert('Error updating account'); // Show error message
            }
        });
    });

    // Modal show event to pre-populate the form
    $('#updateAccountModal').on('show.bs.modal', function(event) {
        var button = $(event.relatedTarget); // Button that triggered the modal
        var accountId = button.data('account-id'); // Extract info from data-* attributes

        // Clear previous values
        $('#update-form-bank-name').val('');
        $('#update-form-currency').val('');
        $('#update-form-balance').val('');
        $('#update-form-category').val('');

        // Fetch and populate form if accountId is provided
        if (accountId) {
            $.getJSON(`/bank-accounts/details/${accountId}`, function(account) {
                $('#update-account-id').val(accountId); // Assuming this is a dropdown to select the account ID
                $('#update-form-bank-name').val(account.bank_name);
                $('#update-form-currency').val(account.currency);
                $('#update-form-balance').val(account.balance);
                $('#update-form-category').val(account.category);
                $('#update-form-status').val(account.status);
            }).fail(function() {
                alert('Error fetching account details');
            });
        }
    });
});
</script>
<script>
// Handle delete account form submission
$('#deleteAccountForm').on('submit', function(e) {
  e.preventDefault();
  $.ajax({
    type: 'DELETE',
    url: '/bank-accounts/' + $('#delete-account-id').val(),
    success: function(response) {
      // Store success message in session storage before reloading
      sessionStorage.setItem('deleteSuccess', 'Bank account deleted successfully');

      // Reload the page to reflect changes
      window.location.reload();
    },
    error: function(response) {
      alert('Error deleting account');  // Show error message
    }
  });
});

// Check for a delete success message after the page loads
$(document).ready(function() {
  var deleteSuccess = sessionStorage.getItem('deleteSuccess');
  if (deleteSuccess) {
    alert(deleteSuccess); // Or display in a more user-friendly component like a toast
    sessionStorage.removeItem('deleteSuccess'); // Clear the message from storage
  }
});
</script>

    <script>
  // Select all elements containing numbers
  var numberElements = document.querySelectorAll('body *');

  // Loop through each element and format numbers
  numberElements.forEach(function(element) {
    // Match numbers using regular expression
    var text = element.innerHTML;
    var formattedText = text.replace(/\b(\d+)\b(?=\.\d+)/g, function(match, number) {
      // Add space as a thousands separator
      return number.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1 ');
    });
    // Update the content of the element with formatted text
    element.innerHTML = formattedText;
  });
</script>
  <!-- Template Main JS File -->
  <script src="{{ url_for('user_bp.static', filename='js/main.js') }}"></script>
  <!-- End custom js for this page-->
</body>

</html>

